<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>金牌厨柜</title>
	<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no,viewport-fit=cover"/>
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black" /> 
	<meta name="format-detection" content="telephone=no" /> 
	<meta name="format-detection" content="email=no" /> 
	<link rel="stylesheet" type="text/css" href="css/normalize.css">
	<link rel="stylesheet" type="text/css" href="css/index.css">
	<script type="text/javascript" src="js/163scale.js"></script>
</head>
<body>

<div class="bg-list">
	<img src="images/index_01.jpg">
	<img src="images/index_02.jpg">
</div>

<div class="content">

	<div class="rotate" style="top: 2.8rem">
		<div class="rotate-img"><img src="images/rotate.png"></div>
		<div class="rotate-pointer"><img src="images/pointer.png"></div>
		<a class="rule-link" href="gifts.html">抽奖规则必看</a>
	</div>

</div>

<script type="text/javascript" src="js/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="js/jQueryRotate.js"></script>
<script type="text/javascript">
$(function(){


function runzp(result) {
	// 奖项json
	var data = [
		{"id":1,"message":"一等奖：11",},
		{"id":2,"message":"二等奖：22"},
		{"id":3,"message":"三等奖：33"},
		{"id":4,"message":"四等奖：44"},
		{"id":5,"message":"五等奖：55"},
		{"id":6,"message":"安慰奖：继续努力！"}
	];
	var myreturn = new Object();
	var index = parseInt(result) - 1; 
	myreturn.angle = ( parseInt(data[index].id) - 1)* (360/data.length);
	myreturn.message = data[index].message;
	return myreturn;
}
// 转盘
var rotateFlag = true;
$(".rotate-pointer").rotate({
    bind:{
        click:function(){
            if(rotateFlag){
                rotateFlag = false;
                $.ajax({
                    url:' ',
                    type:'get',
                    dataType: "json", 
                    data:{ },
                    success:function(res){
                        if(res.code == 0){
                            //抽奖成功  
                            var gamereturn = runzp(res.result); ;         
                            $('.rotate-pointer').rotate({
                                duration:3000,                      //转动时间
                                angle: 0,                           //起始角度
                                animateTo:1440+gamereturn.angle,    //结束的角度
                                //easing: $.easing.easeOutSine,     //动画效果，需加载jquery.easing.min.js
                                callback: function(){
                                    var msg = gamereturn.data[res.result-1].message;
                                    alert(1);
                                    rotateFlag = true;
                                }
                            });                      
                        } else {
                            alert(res.msg);
                            rotateFlag = true;
                        }                                           
                    },
                    error:function(){
                        alert('请刷新重试！');
                        rotateFlag = true;
                    }
                })
            }
        }
    }
}); 

})
</script>
</body>
</html>